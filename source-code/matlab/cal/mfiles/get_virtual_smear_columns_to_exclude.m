function [virtualSmearColsToExcludeDueToSpilledCharge, channelsWithBadCols] = ...
    get_virtual_smear_columns_to_exclude(season, channel)
%
% Function to extract the 1-based CCD column indices where the virtual smear is
% corrupted by spilled charge from a saturated star. There is a set of
% columns for each channel (possibly empty) for each season.
%
% Inputs:
%   season: 0-3 Kepler season 0=summer (Q2,Q6,Q10,...)
%   channel: 1-84 focal plane channel number
%
% Outputs:
%   virtualSmearColsToExcludeDueToSpilledCharge: column array of 1-based
%   column numbers to exclude, possibly empty
%
% 
% Copyright 2017 United States Government as represented by the
% Administrator of the National Aeronautics and Space Administration.
% All Rights Reserved.
% 
% NASA acknowledges the SETI Institute's primary role in authoring and
% producing the Kepler Data Processing Pipeline under Cooperative
% Agreement Nos. NNA04CC63A, NNX07AD96A, NNX07AD98A, NNX11AI13A,
% NNX11AI14A, NNX13AD01A & NNX13AD16A.
% 
% This file is available under the terms of the NASA Open Source Agreement
% (NOSA). You should have received a copy of this agreement with the
% Kepler source code; see the file NASA-OPEN-SOURCE-AGREEMENT.doc.
% 
% No Warranty: THE SUBJECT SOFTWARE IS PROVIDED "AS IS" WITHOUT ANY
% WARRANTY OF ANY KIND, EITHER EXPRESSED, IMPLIED, OR STATUTORY,
% INCLUDING, BUT NOT LIMITED TO, ANY WARRANTY THAT THE SUBJECT SOFTWARE
% WILL CONFORM TO SPECIFICATIONS, ANY IMPLIED WARRANTIES OF
% MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR FREEDOM FROM
% INFRINGEMENT, ANY WARRANTY THAT THE SUBJECT SOFTWARE WILL BE ERROR
% FREE, OR ANY WARRANTY THAT DOCUMENTATION, IF PROVIDED, WILL CONFORM
% TO THE SUBJECT SOFTWARE. THIS AGREEMENT DOES NOT, IN ANY MANNER,
% CONSTITUTE AN ENDORSEMENT BY GOVERNMENT AGENCY OR ANY PRIOR RECIPIENT
% OF ANY RESULTS, RESULTING DESIGNS, HARDWARE, SOFTWARE PRODUCTS OR ANY
% OTHER APPLICATIONS RESULTING FROM USE OF THE SUBJECT SOFTWARE.
% FURTHER, GOVERNMENT AGENCY DISCLAIMS ALL WARRANTIES AND LIABILITIES
% REGARDING THIRD-PARTY SOFTWARE, IF PRESENT IN THE ORIGINAL SOFTWARE,
% AND DISTRIBUTES IT "AS IS."
% 
% Waiver and Indemnity: RECIPIENT AGREES TO WAIVE ANY AND ALL CLAIMS
% AGAINST THE UNITED STATES GOVERNMENT, ITS CONTRACTORS AND
% SUBCONTRACTORS, AS WELL AS ANY PRIOR RECIPIENT. IF RECIPIENT'S USE OF
% THE SUBJECT SOFTWARE RESULTS IN ANY LIABILITIES, DEMANDS, DAMAGES,
% EXPENSES OR LOSSES ARISING FROM SUCH USE, INCLUDING ANY DAMAGES FROM
% PRODUCTS BASED ON, OR RESULTING FROM, RECIPIENT'S USE OF THE SUBJECT
% SOFTWARE, RECIPIENT SHALL INDEMNIFY AND HOLD HARMLESS THE UNITED
% STATES GOVERNMENT, ITS CONTRACTORS AND SUBCONTRACTORS, AS WELL AS ANY
% PRIOR RECIPIENT, TO THE EXTENT PERMITTED BY LAW. RECIPIENT'S SOLE
% REMEDY FOR ANY SUCH MATTER SHALL BE THE IMMEDIATE, UNILATERAL
% TERMINATION OF THIS AGREEMENT.
%
 


switch season
	case{0} 
		channelsWithBadCols = [... 
			5; 6; 8; 22; 23; 24; 33; 34; 35; 36; 60; 67; ]; 
		virtualSmearSpilledChargeCols = {...
			[ 504 505 ];... 
			[ 504 505 506 ];... 
			[ 504 505 ];... 
			[ 435 436 437 ];... 
			[ 434 435 436 437 438 439 ];... 
			[ 435 436 437 ];... 
			[ 411 412 591 592 593 ];... 
			[ 410 411 412 413 414 565 567 568 591 592 593 ];... 
			[ 411 412 413 564 565 566 567 568 569 591 592 593 594 ];... 
			[ 411 412 565 566 567 589 590 591 592 593 594 595 ];... 
			[ 341 342 343 ];... 
			[ 395 396 397 398 ];... 
			}; 

	case{1} 
		channelsWithBadCols = [... 
			4; 27; 33; 34; 35; 36; 38; 39; 40; 41; 42; 43; 44; 68; ...
			77; 78; 79; 80; 82; ]; 
		virtualSmearSpilledChargeCols = {...
			[ 757 ];... 
			[ 395 396 397 398 ];... 
			[ 505 506 ];... 
			[ 504 505 506 507 ];... 
			[ 505 506 ];... 
			[ 505 506 ];... 
			[ 435 436 437 ];... 
			[ 434 435 436 437 438 439 ];... 
			[ 435 436 437 ];... 
			[ 457 458 459 ];... 
			[ 456 457 458 459 460 ];... 
			[ 457 458 ];... 
			[ 457 458 ];... 
			[ 337 338 339 340 ];... 
			[ 414 415 587 588 589 ];... 
			[ 413 414 415 416 417 569 570 571 587 588 589 ];... 
			[ 414 415 416 568 569 570 571 572 573 587 588 589 ];... 
			[ 414 415 569 570 571 586 587 588 589 590 591 ];... 
			[ 446 648 649 650 ];... 
			}; 

	case{2} 
		channelsWithBadCols = [... 
			25; 28; 29; 30; 31; 49; 50; 51; 52; 53; 57; 61; 62; 63; ...
			64; 74; 77; 78; 79; 80; ]; 
		virtualSmearSpilledChargeCols = {...
			[ 338 ];... 
			[ 337 338 339 340 ];... 
			[ 445 446 ];... 
			[ 444 445 647 648 ];... 
			[ 445 446 ];... 
			[ 414 415 587 588 ];... 
			[ 413 414 415 416 417 418 587 588 ];... 
			[ 413 414 415 416 417 418 569 570 571 572 573 587 588 589 590 ];... 
			[ 414 415 570 571 586 587 588 588 589 590 ];... 
			[ 445 ];... 
			[ 54 55 56 ];... 
			[ 439 440 ];... 
			[ 439 440 441 ];... 
			[ 438 439 440 441 442 443 444 ];... 
			[ 439 440 441 ];... 
			[ 101 102 ];... 
			[ 509 510 ];... 
			[ 508 509 510 511 ];... 
			[ 307 308 309 509 510 ];... 
			[ 509 510 ];... 
			}; 

	case{3} 
		channelsWithBadCols = [... 
			2; 20; 29; 30; 31; 32; 41; 43; 44; 46; 47; 48; 49; 50; ...
			51; 52; 57; 59; 65; ]; 
		virtualSmearSpilledChargeCols = {...
			[ 440 441 442 642 643 644 ];... 
			[ 341 342 343 ];... 
			[ 283 284 ];... 
			[ 283 284 285 ];... 
			[ 283 284 285 ];... 
			[ 282 283 284 285 286 ];... 
			[ 460 461 ];... 
			[ 460 461 ];... 
			[ 459 460 461 462 463 ];... 
			[ 439 440 441 ];... 
			[ 438 439 440 441 442 443 ];... 
			[ 439 440 441 ];... 
			[ 509 510 ];... 
			[ 508 509 510 511 ];... 
			[ 509 ];... 
			[ 509 ];... 
			[ 689 690 ];... 
			[ 391 392 393 394 ];... 
			[ 49 50 51 ];... 
			}; 

end 
ichannel = find(channelsWithBadCols == channel); 

if ~isempty(ichannel) 
	virtualSmearColsToExcludeDueToSpilledCharge = sort(virtualSmearSpilledChargeCols{ichannel}); 
else 
	virtualSmearColsToExcludeDueToSpilledCharge =[]; 
end 

return; 
